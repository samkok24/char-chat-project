# 챕터8 과금 체계 및 결제 상품 설계

**작성일**: 2026-02-22
**상태**: 확정 (구현 전)

---

## 1. 루비 화폐 체계

| 항목 | 값 |
|------|---|
| **단위** | 루비 (💎) |
| **환율** | 1루비 = 10원 |
| **최소 단위** | 1루비 (정수만 사용) |
| **표시** | 모델 옆에 💎+숫자 또는 "무료" |

---

## 2. 서비스 모델 라인업 및 루비 단가

### 확정 모델 (9종)

| 루비 | 원가 | 모델 | API원가/턴 | 마진 | TTFB | 총시간 | 글자수 | 말풍선 | 잘림 | 품질점수 | 장단점 |
|------|------|------|-----------|------|------|--------|--------|--------|------|---------|--------|
| **무료** | 0원 | Gemini 2.5 Flash | 1.0원 | - | 1.9s | **2.8s** | 362 | 3.4 | 3/10 | 329 | 최속+최저원가. 가끔 잘림 |
| **💎3** | 30원 | Claude Haiku 4.5 | 5.6원 | 81% | **0.94s** | 4.61s | 377 | 6.0 | 0/10 | 313 | TTFB 최속, 잘림 해소. Claude 감성 |
| **💎5** | 50원 | Gemini 3 Flash (Preview) | 1.0원 | 98% | 2.14s | 4.58s | **605** | **9.6** | 0/10 | 514 | 💎5의 수익 엔진. Pro급 품질 |
| **💎5** | 50원 | Claude Sonnet 4 | 21.3원 | 57% | 1.79s | 9.83s | 386 | 5.7 | 0/10 | 328 | Claude 감성 묘사 |
| **💎5** | 50원 | Gemini 2.5 Pro Standard | 10.1원 | 80% | 3.0s | 5.8s | 510 | 7.3 | 1/10 | 439 | 긴 글+빠른 편. 간헐 잘림 |
| **💎5** | 50원 | GPT-5.1 | 17.5원 | 65% | 3.56s | 7.45s | 449 | 4.0 | 0/10 | 391 | GPT 이해력 |
| **💎7** | 70원 | Claude Sonnet 4.5 | 21.8원 | 69% | 1.64s | 10.79s | 434 | 7.0 | 0/10 | 356 | **안정성 1위** (편차±33) |
| **💎7** | 70원 | Gemini 3 Pro (Preview) | 11.5원 | 84% | 5.1s | 9.0s | **627** | 5.8 | 0/10 | **558** | **품질 1위** (627자) |
| **💎7** | 70원 | GPT-5.2 | 23.8원 | 66% | 3.40s | 8.75s | 427 | 6.1 | 0/10 | 380 | GPT 최신, 대화 풍부 |

> 품질점수 = 글자수 × 한국어비율

### 티어 구조

```
무료           💎3(30원)        💎5(50원)           💎7(70원)
"가볍게"       "안정적으로"      "풍부하게"          "최고로"
───────        ───────────      ────────────        ──────────────
2.5 Flash      Haiku 4.5        3 Flash             Sonnet 4.5
                                Sonnet 4            3 Pro
                                2.5 Pro             GPT-5.2
                                GPT-5.1
```

### 티어 설계 근거

- **무료 → 💎3**: "잘림이 싫다" → 30원으로 잘림 0/10 + TTFB 최속
- **💎3 → 💎5**: "더 길고 풍부한 응답" → 3 Flash 605자 9.6말풍선이 가격 정당화
- **💎5 → 💎7**: "최고 중의 최고" → 각 프로바이더별 1위 모델 (Claude 안정/Gemini 품질/GPT 최신)
- **3 Flash를 💎5에 둔 이유**: 605자/9.6말풍선은 💎3 이하에 두면 💎5 모델의 존재 이유가 사라짐. API원가 1.0원 → 마진 98%로 💎5 티어의 수익 엔진 역할

### 제외 모델 (4종)

| 모델 | 제외 사유 |
|------|---------|
| GPT-5 mini | 302자/2.0말풍선, TTFB 5.08s 느림. Haiku가 상위호환 |
| Claude Opus 4.1 | API원가 107.9원 — 💎7(70원)에도 적자 |
| Claude Opus 4.5 | API원가 107.3원 — 동일 |
| GPT-4.1 mini | 229자, 대사없음 2/10 — 품질 부족 |

---

## 3. 경쟁사 대비 가격 비교

### 동일 모델 기준 1턴 비용

| 모델 | 챕터8 | 크랙 | 바베챗 |
|------|-------|------|--------|
| 무료 | Flash (1.0원) | Haiku 구형 (1.7원) | 미공개 저가 |
| Flash 급 | **무료** | 20원 (파워챗) | 정액 무제한 |
| Gemini 3 Flash | **50원** | 없음 | 33~38원 |
| Sonnet 4 | 50원 | 50원 (슈퍼챗1.5) | 없음 |
| Gemini 2.5 Pro | 50원 | 50원 (프로챗1.0) | 76~98원 |
| Gemini 3 Pro | **70원** | 58원 (프로챗2.0) | 없음 |
| Sonnet 4.5 | **70원** | 50원 (슈퍼챗2.0) | 없음 |
| GPT-5.1 / 5.2 | **50~70원** | 없음 | 없음 |
| Opus | 미제공 | 75원 (적자) | 없음 |

> GPT 3종(5-mini 제외) 독점 제공. 무료 모델 원가 크랙 대비 40% 저렴.
> Sonnet 4.5는 크랙(50원)보다 20원 비싸지만, 💎5에 3 Flash(605자)라는 가성비 대안 존재.

### 크랙 마진 추정

| 모드 | 모델 | 판매가 | API원가 | 마진% |
|------|------|--------|--------|-------|
| 일반챗 | Claude 3 Haiku (구형) | 무료 | 1.7원 | - |
| 파워챗 | Gemini 2.5 Flash | 20원 | 1.0원 | 95% |
| 프로챗 1.0 | Gemini 2.5 Pro | 50원 | 10.1원 | 80% |
| 프로챗 2.0 | Gemini 3 Pro | 58원 | 11.5원 | 80% |
| 슈퍼챗 1.5 | Sonnet 4 | 50원 | 21.3원 | 57% |
| 슈퍼챗 2.0 | Sonnet 4.5 | 50원 | 21.8원 | 56% |
| 하이퍼챗 | Opus 4.6 | 75원 | 107원 | 적자 |

---

## 4. 무료 혜택 정책

### 4-1. Flash 무제한

| 항목 | 내용 |
|------|------|
| **모델** | Gemini 2.5 Flash |
| **제한** | 없음 (무제한) |
| **루비 소모** | 0 |
| **API 원가** | 1.0원/턴 |

### 4-2. 일일 루비 지급

| 항목 | 내용 |
|------|------|
| **지급량** | 10루비/일 |
| **원화 가치** | 100원 |
| **지급 조건** | 매일 접속 시 (1일 1회) |
| **사용 가능 턴** | Haiku 3턴 / 💎5 모델 2턴 / 💎7 모델 1턴 |

### 4-3. 타이머 리필

| 항목 | 내용 |
|------|------|
| **리필 속도** | 1루비/2시간 |
| **캡 (최대 누적)** | 15루비 |
| **하루 최대** | 최대 12루비 (타이머만, 24시간 기준) |
| **일일지급 포함 최대** | ~20루비/일 (200원 가치) |

### 4-4. 무료 유저 일일 시나리오

```
접속 보상:  +10💎 (1일 1회)
타이머:     2시간마다 +1💎 (최대 15💎 누적)
일일 최대:  ~20💎 (활동 시간에 따라)
무료 모델:  Gemini 2.5 Flash 무제한 (루비 불필요)

→ 20💎으로 가능한 유료 모델 사용:
  Haiku 💎3: 6턴
  중급  💎5: 4턴
  프리미엄 💎7: 2턴
```

### 4-5. 무료 원가 비교 (유저당)

| 항목 | 일일 | 월간 (30일) |
|------|------|-----------|
| Flash 무제한 (평균 20턴/일) | 20원 | 600원 |
| 일일 루비 10개 | 1~21.8원 | 30~654원 |
| 타이머 루비 (평균 8개/일) | 0.8~17.4원 | 24~523원 |
| **합계 (최대)** | **~59원/일** | **~1,777원/월** |

> 기존 Haiku 무제한(~4,995원/월) 대비 **64% 절감**
> MAU 1만 기준 월 무료 비용: ~1,777만원

### 4-6. 경쟁사 무료 혜택 비교

| | 챕터8 | 크랙 | 바베챗 |
|---|---|---|---|
| **무료 모델** | Gemini 2.5 Flash 무제한 | Claude 3 Haiku 무제한 | 기본챗 무제한 |
| **무료 원가/턴** | **1.0원** | 1.7원 | ? |
| **일일 재화** | 💎10 + 타이머(2h/1💎) | 350크래커 | 10프로챗 (출석) |
| **원화 환산** | ~200원/일 | 350원/일 | ~760~980원/일 |

---

## 5. 루비 충전 상품 (5단계)

### 상품 구성

| 상품명 | 가격 | 기본 루비 | 보너스 | 총 루비 | 루비당 단가 | 할인율 |
|--------|------|----------|--------|--------|-----------|-------|
| 라이트 | 2,000원 | 200 | - | 200 | 10.0원 | - |
| 베이직 | 5,000원 | 500 | +25 | 525 | 9.5원 | 5% |
| 프리미엄 | 10,000원 | 1,000 | +100 | 1,100 | 9.1원 | 9% |
| 프로 | 30,000원 | 3,000 | +400 | 3,400 | 8.8원 | 12% |
| 마스터 | 50,000원 | 5,000 | +800 | 5,800 | 8.6원 | 14% |

### 상품별 사용 가능 턴 수

| 상품 | 💎3 Haiku | 💎5 | 💎7 |
|------|----------|-----|-----|
| 라이트 (200) | 66턴 | 40턴 | 28턴 |
| 베이직 (525) | 175턴 | 105턴 | 75턴 |
| 프리미엄 (1,100) | 366턴 | 220턴 | 157턴 |
| 프로 (3,400) | 1,133턴 | 680턴 | 485턴 |
| 마스터 (5,800) | 1,933턴 | 1,160턴 | 828턴 |

---

## 6. 결제 페이지 UI 설계

### 6-1. PG: Paddle

| 항목 | 내용 |
|------|------|
| **PG사** | Paddle |
| **한국 결제수단** | 신용/체크카드 (신한, 현대, 삼성, 국민 등 22개+), 네이버페이, 카카오페이, 삼성페이, 페이코 |
| **해외 결제수단** | Visa, Mastercard, PayPal, Apple Pay, Google Pay 등 |
| **정기결제** | 지원 (구독 Phase에서 활용) |
| **세금 처리** | Paddle이 MoR(Merchant of Record)로 세금 자동 처리 |

### 6-2. 페이지 구조

```
┌───────────────────────────────────────────┐
│  💎 내 루비: 142                            │
│  ⏱ 타이머 리필: 1시간 23분 후 (8/15)         │
├───────────────────────────────────────────┤
│  [루비 충전]  [무료 루비]                     │  ← 탭 2개
├───────────────────────────────────────────┤
│                                           │
│  ── 루비 충전 탭 ──                         │
│                                           │
│  ┌─────────┐  ┌─────────┐               │
│  │ 라이트   │  │ 베이직   │               │
│  │ 💎200   │  │ 💎525   │               │
│  │         │  │ +25보너스 │               │
│  │ 2,000원 │  │ 5,000원  │               │
│  └─────────┘  └─────────┘               │
│                                           │
│  ┌─────────────────┐  ┌─────────┐       │
│  │ 프리미엄         │  │ 프로     │       │
│  │ 💎1,100         │  │ 💎3,400 │       │
│  │ +100보너스       │  │ +400보너스│       │
│  │ 10,000원        │  │ 30,000원 │       │
│  └─────────────────┘  └─────────┘       │
│                                           │
│  ┌─────────────────────────────┐         │
│  │ 마스터                       │         │
│  │ 💎5,800 (+800보너스)         │         │
│  │ 50,000원                    │         │
│  └─────────────────────────────┘         │
│                                           │
│  → Paddle Checkout (카드/네이버/카카오/삼성) │
│                                           │
├───────────────────────────────────────────┤
│                                           │
│  ── 무료 루비 탭 ──                         │
│                                           │
│  📅 오늘의 출석 보상                         │
│  ┌─────────────────────────────┐         │
│  │ 💎10  일일 보상              │         │
│  │ [받기] 또는 ✅ 수령 완료       │         │
│  └─────────────────────────────┘         │
│                                           │
│  ⏱ 타이머 리필                              │
│  ┌─────────────────────────────┐         │
│  │ 2시간마다 💎1 자동 충전       │         │
│  │ 현재: 8/15  다음: 1시간 23분 후 │         │
│  │ [██████████░░░░░░░░░░] 8/15 │         │
│  └─────────────────────────────┘         │
│                                           │
│  🎬 광고 시청 (준비중)                       │
│  ┌─────────────────────────────┐         │
│  │ 영상 시청 시 💎3 지급         │         │
│  │ [준비중]                     │         │
│  └─────────────────────────────┘         │
│                                           │
└───────────────────────────────────────────┘
```

### 6-3. 진입점

| 위치 | 동작 |
|------|------|
| **헤더** | 💎 아이콘 + 잔액 표시 → 클릭 시 충전 페이지 |
| **모델 선택 모달** | 유료 모델 선택 시 잔액 부족하면 충전 유도 |
| **채팅 중** | 루비 부족 시 인라인 토스트 → "충전하기" 링크 |

---

## 7. 마진 시뮬레이션

### 유저 분포별 예상 마진 (월 10만 턴)

| 시나리오 | 무료 | 💎3 | 💎5 | 💎7 | 매출 | API원가 | 마진% |
|---------|------|-----|-----|-----|------|--------|-------|
| 초기 | 50% | 20% | 20% | 10% | 180만 | 51만 | **72%** |
| 성장기 | 35% | 15% | 30% | 20% | 290만 | 68만 | **77%** |
| 성숙기 | 20% | 10% | 40% | 30% | 400만 | 80만 | **80%** |

> Gemini 3 Flash(98%)와 Gemini 3 Pro(84%)의 고마진이 Sonnet/GPT의 저마진(52~69%)을 보조.

---

## 8. 구현 우선순위

### Phase 1: UI + 충전 기본 (현재)
- [x] 모델 선택 모달에 루비 단가 표시
- [ ] 루비 충전 페이지 리뉴얼 (5상품 + 2탭)
- [ ] 헤더에 루비 잔액 + 타이머 표시
- [ ] 모델 선택 모달 가격 업데이트 (최종 티어 반영)

### Phase 2: 과금 연동
- [ ] 턴당 루비 차감 로직 (chat.py)
- [ ] 무료 모델(Flash) 무제한 처리
- [ ] 잔액 부족 시 UI 처리 (토스트 + 충전 유도)
- [ ] 스트림 실패 시 미차감 처리

### Phase 3: 무료 루비 시스템
- [ ] 일일 루비 지급 (출석 보상)
- [ ] 타이머 리필 (1루비/2시간, 캡 15)
- [ ] 리필 상태 API + 프론트 타이머 UI

### Phase 4: Paddle 연동
- [ ] Paddle 계정/상품 설정
- [ ] Paddle Checkout 연동 (Overlay/Inline)
- [ ] 웹훅 처리 (transaction.completed → 루비 지급)
- [ ] 결제 내역 / 환불 처리

### Phase 5: 구독 (추후)
- [ ] 구독 상품 설계
- [ ] Paddle 정기결제 연동
- [ ] 구독자 혜택 (보너스 루비, 리필 속도 증가 등)

---

## 9. 기존 코드 현황

| 구분 | 파일 | 상태 |
|------|------|------|
| 충전 UI | `frontend/.../pages/RubyChargePage.jsx` | 데모 (하드코딩 4상품) → 리뉴얼 필요 |
| 결제 API | `backend-api/app/api/payment.py` | 스캐폴딩 (PG 미연동) → Paddle로 교체 |
| 포인트 API | `backend-api/app/api/point.py` | 동작 (Redis Lua 원자적 차감) |
| 포인트 서비스 | `backend-api/app/services/point_service.py` | 동작 |
| DB 모델 | `backend-api/app/models/payment.py` | PaymentProduct, Payment, PointTransaction, UserPoint |
| 모델 선택 UI | `frontend/.../components/ModelSelectionModal.jsx` | 루비 아이콘 적용 (가격 업데이트 필요) |
| 비즈니스 규칙 | `PAYMENT_PLAN.md`, `PAYMENT_GATE_NOTES_2026-02-20.md` | 문서화됨 |
