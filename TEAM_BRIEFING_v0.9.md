# v0.9 업데이트 팀 브리핑

> **작성일**: 2026-02-07  
> **대상**: QA 담당자 / 팀원 전원  
> **목적**: 지난 1개월간 진행한 대규모 업데이트의 전체 그림을 공유하고, QA를 시작하기 위한 배경 지식을 전달합니다.

---

## 1. 한 줄 요약

**"캐릭터를 만드는 방법"과 "캐릭터와 대화하는 방식" 전체를 리뉴얼했습니다.**

기존에는 캐릭터를 만들 때 이름/설명/프롬프트 정도만 입력했고, 대화는 무한히 이어지기만 했습니다.  
이번 업데이트로 **스토리 구조를 직접 설계**할 수 있게 되었습니다.

---

## 2. 이전 버전(v0.8)과 뭐가 달라졌나

### 이전 (v0.8)
- 캐릭터 생성: 이름, 설명, 프롬프트, 인사말 입력 → 저장 → 끝
- 대화: 인사말 하나로 시작 → 무한 대화
- 분류: 남성향/여성향 + 장르 태그만 존재
- 홈: 메인 탭 / 스토리에이전트 탭 으로 분리

### 이후 (v0.9)
- 캐릭터 생성: **위저드**(고급) 또는 **30초 모달**(빠른 생성) 두 가지 경로
- 대화: **여러 오프닝** 중 선택 → 대화 시작 → **턴수별 사건** 발생 → **엔딩** 도달
- 분류: **롤플레잉 / 시뮬레이터 / 커스텀** 모드 + 기존 태그
- 홈: 탭 제거, 스토리에이전트는 사이드바로 이동

---

## 3. 핵심 개념 설명 (이것만 알면 QA 가능)

### 3-1. 캐릭터 모드 (3가지)

| 모드 | 설명 | 예시 |
|------|------|------|
| **롤플레잉 (RP)** | 대화/스토리 중심. 대부분의 캐릭터가 이 타입 | "카페 알바 남자친구", "판타지 모험가" |
| **시뮬레이터** | 게임/목표/룰 중심. 스탯, 승패 조건 등이 존재 | "좀비 서바이벌", "연애 시뮬레이션" |
| **커스텀** | 프롬프트를 사용자가 직접 작성하는 고급 모드 | 개발자/고급 유저용 |

- 위저드에서 생성 시 첫 단계에서 모드를 선택합니다.
- 30초 모달에서도 롤플/시뮬 중 선택 가능합니다.
- 홈 캐릭터 탭에서 `롤플` / `시뮬` / `커스텀` 태그로 필터링 가능합니다.

### 3-2. 오프닝 (시작 시나리오)

**하나의 캐릭터에 여러 개의 시작 시나리오를 설정할 수 있는 기능입니다.**

- 각 오프닝에는 **이름**, **첫상황(도입부)**, **첫대사**가 있습니다.
- 예시:
  - 오프닝 1: "일상 모드" → 학교에서 만남 → "오늘도 수업 지루하지?"
  - 오프닝 2: "긴급 모드" → 비상 상황 → "빨리 도망쳐! 저쪽이 무너진다!"
- 유저가 **상세페이지/모달에서 오프닝을 골라서** 대화를 시작합니다.
- 오프닝이 1개여도 칩(둥근 버튼)으로 표시됩니다.

**확인 포인트**: 모달/상세페이지에서 두 번째 오프닝을 선택하고 대화 시작 → 실제로 두 번째 오프닝 내용으로 채팅이 시작되는지 반드시 확인

### 3-3. 턴수별 사건

**"몇 턴째에 이런 일이 일어난다"를 크리에이터가 미리 설정하는 기능입니다.**

- 예: "10턴째에 적이 습격", "25턴째에 비밀 편지 발견", "50턴째에 배신"
- 각 사건에는 **반드시 삽입할 지문**과 **반드시 삽입할 대사**를 지정 가능합니다.
- 지문/대사 안에 이미지 코드(`[[img:URL]]`)를 넣으면 인라인 이미지로 렌더링됩니다.

**왜 중요한가**: 다른 경쟁 서비스들은 "무한 대화"만 있음. 챕터8은 **스토리에 긴장감과 구조를 부여**할 수 있는 유일한 기능.

### 3-4. 엔딩

**캐릭터에 최대 턴수를 설정하면, 이야기에 끝이 생깁니다.**

- 최대 턴에 도달하면 **에필로그(마무리 텍스트)**가 표시됩니다.
- 에필로그에도 이미지 삽입 가능합니다.
- 턴수를 설정하지 않으면 기존처럼 **무한 대화(∞)**입니다.
- 캐릭터 카드에 **턴수 배지**가 표시됩니다. (예: `200턴`, `∞`)

### 3-5. 설정메모

**특정 키워드가 대화에 등장하면 AI가 참조하는 메모 시스템입니다.**

- **트리거**: 대화에 이 단어가 나오면 → 설정메모 내용을 AI에게 전달
- **적용 대상**: 어떤 오프닝에 이 메모를 적용할지 선택 가능
- 적용 대상 드롭다운에는 **오프닝 이름**이 표시되어야 합니다. ("기본설정1" 아님)

### 3-6. 인라인 이미지

**대사/지문/에필로그 텍스트 안에 이미지를 삽입하는 기능입니다.**

- 형식: `[[img:이미지URL]]` 또는 `{{img:이미지URL}}`
- 텍스트 코드 대신 **실제 이미지가 렌더링**되어야 합니다.
- 적용되는 곳: 첫상황, 첫대사, AI 응답(지문/대사), 턴수별 사건, 엔딩 에필로그

---

## 4. 캐릭터 생성 경로 (2가지)

### 경로 A: 위저드 (고급 생성)

- **접근**: 사이드바 "캐릭터 만들기" 또는 `/create`
- **단계**: 프로필(모드 선택) → 미디어 → 오프닝 → 프롬프트 → 설정메모 → 턴수별 사건 → 엔딩
- **대상**: 세밀한 캐릭터를 만들고 싶은 크리에이터

### 경로 B: 30초 모달 (빠른 생성)

- **접근**: 홈에서 "빠르게 캐릭터 만들기" 버튼
- **입력**: 이미지 + 이름 + 한줄소개 + 성향(남성향/여성향) + 모드(롤플/시뮬)
- **동작**: AI가 나머지(프롬프트, 오프닝, 성격 등)를 자동 생성 (30초~2분)
- **대상**: 빠르게 캐릭터를 만들고 싶은 일반 유저

---

## 5. UI 변경 요약

### 홈
- ~~메인 탭 / 스토리에이전트 탭~~ → **탭 제거**
- 스토리 에이전트는 **사이드바 "대화내역" 아래 버튼**으로 이동
- PC에서 섹션 제목 옆 좌우 화살표(`< >`) 제거 → "더보기"만 노출

### 캐릭터 탭 (필터)
- "전체" → **"모두"**로 워딩 변경
- "모두" 다음에 **롤플 / 시뮬 / 커스텀** 태그 추가
- 그 뒤로 기존 장르 태그(판타지, 로맨스 등)

### 캐릭터 카드 (격자)
- 턴수 배지 추가 (이미지 위, 예: `200턴` 또는 `∞`)
- 태그 영역에 **롤플/시뮬/커스텀** 태그 추가
- 태그 여러 줄 줄바꿈(wrap) 처리

### 모달 / 상세페이지
- ~~"캐릭터" 텍스트 배지~~ → **턴수 배지**로 변경
- 태그 위치: **공개일/수정일 아래**
- **오프닝 칩** 추가 (둥근 버튼, 클릭 시 프리뷰 변경)
- "대화 시작" 버튼 → **"선택한 오프닝으로 / 새로 대화"** (2줄 텍스트)
- 태그 디자인: **격자 카드와 동일한 스타일**

### 에이전트 페이지
- 상단 문구: ~~"스토리 에이전트"~~ → **`< 메인으로 가기`** (부등호 1개)
- 클릭 시 홈으로 이동

### 토글 스위치 (전체)
- **ON**: 배경 보라색 + 동그라미(thumb) 오른쪽으로 이동
- **OFF**: 배경 회색 + 동그라미 왼쪽
- 위저드, 30초 모달 모두 동일하게 적용

---

## 6. 버그 수정 내역

| 항목 | 이전 | 수정 후 |
|------|------|---------|
| 토글 스위치 | 배경색만 바뀌고 동그라미가 안 움직임 | 좌↔우 애니메이션 정상 동작 |
| "작품명 구체적으로" 토글 | 라벨이 고정 | OFF: "제목 스타일 자유" / ON: "작품명 구체적으로" 동적 변경 |
| 설정메모 트리거 | "추가" 버튼 눌러도 등록 안 됨 | 정상 등록 |
| 설정메모 적용 대상 | "기본설정1"로 표시 | 오프닝 이름으로 표시 |
| CMS 콘텐츠 검색 | "롤플" 검색 결과 없음 | 정상 검색 (character_type 필터) |
| CMS 모달 | 검색 결과 많으면 버튼 안 보임 | 모달 높이 고정, 버튼 항상 보임 |
| const 재할당 크래시 | QuickMeetCharacterModal에서 런타임 에러 | let으로 수정 |
| 격자 카드 턴수 | 전부 ∞로만 표시 | 실제 턴수(200턴 등) 정상 표시 |

---

## 7. QA 진행 방법

### 준비물
1. **QA TC 리스트**: `QA_TC_LIST_v0.8.md` (138건)
2. **테스트 계정**: 관리자 계정 + 일반 유저 계정
3. **테스트 환경**: PC 브라우저(크롬) + 모바일(크롬 개발자도구 에뮬레이션)

### QA TC 구조
- **A**: 홈/네비게이션 (10건)
- **B**: 캐릭터 탭 태그/필터 (16건)
- **C**: 격자 카드 표기 (10건)
- **D**: 모달/상세페이지 (20건)
- **E**: 위저드 기본 플로우 (26건)
- **F**: 30초 생성 모달 (12건)
- **G**: 채팅 UI (10건)
- **H**: CMS 태그 관리 (10건)
- **I**: CMS 구좌 관리 (16건)
- **J**: 크로스브라우저/안정성 (8건)

### 우선순위
- **P0 (Blocker)**: A-01, B-06, D-07, D-12, E-07, F-06, G-02, I-12
  → 이것들이 실패하면 배포 불가
- **P1 (Critical)**: "이전 버전 버그 수정 확인"으로 표시된 항목
- **P2 (Normal)**: 나머지

### 핵심 시나리오 (최소한 이것만은)
1. **30초 모달로 캐릭터 만들기** → 생성 완료 확인
2. **위저드로 오프닝 2개 설정** → 저장 → 모달에서 두 번째 오프닝 선택 → 대화 시작 → **두 번째 오프닝 내용으로 시작되는지 확인**
3. **롤플/시뮬 필터** 클릭 → 해당 타입만 표시되는지
4. **토글 스위치** 전수 확인 (동그라미 움직이는지)
5. **CMS에서 구좌 활성화/비활성화** 탭 확인

---

## 8. 접근 URL

| 페이지 | 경로 |
|--------|------|
| 홈 | `/` |
| 캐릭터 상세 | `/characters/{id}` |
| 위저드 (캐릭터 생성) | `/create` |
| 위저드 (수정) | `/create?edit={id}` |
| 채팅 | `/chat/{roomId}` |
| 스토리 에이전트 | `/agent` |
| CMS (관리자) | `/cms` |

---

## 9. 기술 참고 (알아두면 좋은 것)

- **DB 변경**: `characters` 테이블에 `start_sets`(JSONB), `character_type`(VARCHAR), `base_language`(VARCHAR) 컬럼 추가
- **마이그레이션**: `postgres_migration.py`에 자동 추가 등록됨
- **AI 서비스**: `quick_character_service.py`가 30초 모달의 자동 생성 핵심 로직
- **프론트 핵심 파일**: `CreateCharacterPage.jsx`(위저드), `QuickMeetCharacterModal.jsx`(30초 모달), `CharacterMobileDetailModal.jsx`(모달), `ChatPage.jsx`(채팅)

---

## 10. 질문이 있으면

이번 업데이트는 제가 혼자 기획/개발을 진행했기 때문에, 모르는 부분이 있으면 바로 질문 주세요.  
QA 도중 애매한 동작은 **스크린샷 + 재현 경로**를 함께 남겨주시면 빠르게 확인하겠습니다.

---

> **첨부 파일**  
> - `QA_TC_LIST_v0.8.md` — QA 테스트케이스 전체 (138건)  
> - `QA_TC_LIST_v0.8.csv` — 엑셀용 (UTF-8 BOM)
