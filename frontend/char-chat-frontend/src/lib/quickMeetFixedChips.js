/**
 * ✅ QuickMeet(30초) 고정 칩 SSOT
 *
 * 목적:
 * - 30초 모달과 위저드(UI/UX)를 같은 칩풀/규칙으로 유지한다(SSOT/DRY).
 * - 외부 의존성 없이(추가 패키지 X) 프론트에서만 재사용한다.
 *
 * 주의:
 * - 이 값들은 "태그 DB를 오염시키지 않고" UI/seed_text 반영용으로만 사용한다.
 * - slug는 문자열(label) 그대로 쓰며, 서버는 `/characters/:id/tags`에서 slug가 없으면 Tag를 생성할 수 있다(기존 구조).
 */

export const QUICK_MEET_GENRE_CHIPS = [
  '판타지', '현대', '동양', '중세', '다크', '어반', '이세계',
  // ✅ 크랙/바베챗 빈출(배경/분위기): RP/시뮬 공통으로 자주 등장
  '일상', '학교', '학원', '아카데미', '청춘',
  '피폐', '무협', 'SF', '공포', '미스터리', '추리',
  '아포칼립스', '좀비', '전쟁',
  // ✅ 확장: 장르 다양성 보강
  '로맨스', '로판', 'BL', 'GL',
  '힐링', '코미디', '액션', '스릴러',
  '느와르', '범죄', '정치', '첩보',
  '데스게임', '디스토피아',
  '사극', '스팀펑크', '사이버펑크',
  '메카', '우주',
  '오컬트', '괴담',
  // ✅ 바베챗/크랙 빈출(장르 태그): 유저가 바로 찾는 키워드라 UI에 노출
  '현대판타지', '어반판타지',
];

export const QUICK_MEET_TYPE_CHIPS = [
  '선생님', '헌터', '기사', '킬러', '비서', '교도관', '사채업자', '정원사', '학생회장', '스승', '제자',
  '재벌', '후계자', '귀족', '도련님', '황제', '황태자', '폭군', '북부대공', '약혼자', '사생아',
  '뱀파이어', '천사', '악마', '엘프', '수인', '구미호', '늑대인간', '서큐버스', '마녀', '성녀', '마법사', '마법소녀',
  '스트리머', '유튜버', '인플루언서', '사축', '스토커',
  // ✅ 크랙/바베챗 빈출(역할/아키타입): RP/시뮬 모두에서 자주 선택되는 직관 키워드
  '메이드', '집사', '학생', '아이돌', '매니저', '히어로', '빌런', '레인저',
];

export const QUICK_MEET_HOOK_CHIPS = [
  '순애', '혐관', '애증', '후회', '재회', '집착', '질투', '소유욕', '가짜→진짜', '정체 숨김',
  '무뚝뚝', '철벽', '싸가지', '까칠', '도도', '냉철함', '능글남', '다정남', '문제아', '허당',
  '인질', '하렘', '전쟁', '작전', '모험', '경쟁', '복수', '권력',
  // ✅ 크랙/바베챗 빈출(톤/관계 훅): 프로필 자동생성에서 "드리프트"를 줄이는 핵심 재료
  '츤데레', '얀데레', '메가데레', '욕데레',
  '무심', '차가움',
  '귀여움', '달달', '로코',
  '소꿉친구', '짝사랑', '오해→해소', '비밀 연애',
  '구원', '구원순애',
  // ✅ 갈등/상호작용(단어 수준): 과한 수위/메타 없이도 톤 차이를 만든다
  '경멸', '매도',
];

/**
 * ✅ 시뮬레이터 전용 훅/행동/소재 칩(SSOT)
 *
 * 배경:
 * - 롤플용 훅은 감정선 중심이라, 시뮬(게임)에서는 "플레이 루프/목표/제약/시스템"을 드러내는 소재가 부족하다.
 *
 * 원칙:
 * - 너무 추상적인 단어만 두지 말고, 유저가 "무슨 게임을 하는지" 바로 떠올릴 수 있는 시스템 키워드를 늘린다.
 * - 태그 DB에 새 slug가 늘어날 수 있으니, 지나치게 세분화된 문장형 키워드는 피한다(단어/짧은 구).
 */
export const QUICK_MEET_HOOK_CHIPS_SIMULATOR = [
  // 플레이 루프/시스템
  '퀘스트', '미션', '루트', '이벤트', '분기', '멀티엔딩', '턴제', '시간제한', '패널티',
  '스탯', '스킬', '스킬트리', '강화', '장비', '아이템', '수집', '제작', '상점',
  // ✅ 크랙/바베챗 시뮬 빈출: "무슨 게임인지"를 한 단어로 설명하는 키워드
  '게임', '텍스트게임', 'RPG', 'TRPG', '오픈월드', '방탈출',
  '주사위', '확률', '랭킹', '승급', '레이드', '보스전',
  '히든직업', '각성', '게이트', '길드',
  '회귀', '빙의', '환생', '전생', '타임루프',
  // 목표(클리어 조건/지향) — ✅ 요구사항: 시뮬에는 "목표"가 반드시 보여야 한다.
  '돈', '부자', '출세', '성공',
  '구원', '보호', '복수', '정의',
  '생존', '탈출', '구출', '잠입',
  '범인추론', '진실규명', '사건해결',
  // 행동/진행
  '탐험', '던전', '공략', '추적', '협상', '거래', '재판', '퍼즐',
  // 리스크/압박
  '봉인', '저주', '감염', '추방', '처형', '파멸', '노예', '빚', '협박', '도청', '감시',
  // 관계/서사(시뮬에서도 자주 쓰이는 축)
  '호감도', '동료', '라이벌', '배신', '동맹', '비밀', '정체 숨김',
  // ✅ 시뮬에서도 매우 빈출(연애 시뮬/하렘/역하렘): 선택지/루트와 궁합이 좋다
  '연애', '하렘', '역하렘',
  // ✅ 크랙/바베챗 크롤링 기반 추가: 시뮬 인기작 빈출 소재
  '서바이벌', '서열', '왕따', '따돌림', '피라미드', '참교육',
  '육아', '성장', '가족', '교육',
  '능력자', '초능력', '이능력', '마법',
  '격투', '전투', '결투',
  '해적', '항해', '대체역사',
  '역전', '전학', '편입',
  '러브코미디', '로코', '짝사랑', '고백',
];

export function uniqStringsPreserveOrder(arr) {
  /**
   * ✅ 문자열 배열 중복 제거(순서 유지)
   *
   * 의도:
   * - 칩 목록은 UI에서 key로도 쓰이므로 중복이 있으면 렌더링이 깨진다.
   * - "공략"처럼 중복이 섞이면 UX가 즉시 망가지므로 SSOT 레벨에서 방어한다.
   */
  try {
    const list = Array.isArray(arr) ? arr : [];
    const out = [];
    const seen = new Set();
    for (const x of list) {
      const s = String(x || '').trim();
      if (!s) continue;
      if (seen.has(s)) continue;
      seen.add(s);
      out.push(s);
    }
    return out;
  } catch (_) {
    return Array.isArray(arr) ? [...arr] : [];
  }
}

export function shuffleCopy(arr) {
  /**
   * ✅ UI 리스트 셔플
   * - 외부 의존성 없이, 원본 불변 유지.
   */
  try {
    const a = Array.isArray(arr) ? [...arr] : [];
    for (let i = a.length - 1; i > 0; i -= 1) {
      const j = Math.floor(Math.random() * (i + 1));
      const tmp = a[i];
      a[i] = a[j];
      a[j] = tmp;
    }
    return a;
  } catch (_) {
    return Array.isArray(arr) ? [...arr] : [];
  }
}

export function getQuickMeetGenrePriority(audienceSlug) {
  /**
   * ✅ 성향별 "선노출" 우선순위(풀은 동일, 순서만 다르게)
   * - 접힘 상태에서 1줄만 보이므로, 앞쪽에 오는 칩이 곧 첫인상이다.
   */
  try {
    const s = String(audienceSlug || '').trim();
    if (s === '여성향') {
      return ['로맨스', '로판', '현대', '판타지', '이세계', '중세', '사극', '동양', '미스터리', '추리', '스릴러', '다크', '학교', '일상', '피폐'];
    }
    if (s === '남성향') {
      return ['판타지', '이세계', '다크', '무협', '어반', '아포칼립스', '전쟁', 'SF', '스릴러', '미스터리', '추리', '느와르', '범죄', '데스게임'];
    }
    // 전체(기본)
    return ['판타지', '현대', '이세계', '로맨스', '다크', '미스터리', '추리', 'SF', '스릴러', '아포칼립스', '학교', '일상'];
  } catch (_) {
    return ['판타지', '현대', '이세계'];
  }
}

