# 개발일지_250730

## 🎯 오늘의 목표
- 장기간의 디버깅으로 인해 불안정해진 로컬 개발 환경을 안정화.
- GitHub 원본 소스를 기준으로, 개발 환경(SQLite)에서 발생하는 근본적인 오류를 해결하고 안정적인 개발 기반을 다시 마련하는 것.

## 🚧 주요 문제 및 디버깅 여정

지난 몇 시간 동안 다음과 같은 심각한 오류들이 연쇄적으로 발생하며 서버 실행이 불가능한 상태가 지속됨.

1.  **`ImportError` (모델 의존성 문제)**: `like`, `comment` 모델을 통합하려는 시도가 `__init__.py`, `user.py` 등 여러 파일의 관계 설정을 복잡하게 만들었고, 이는 수많은 순환 참조 및 `ImportError`를 유발했다.
2.  **`CompileError` (DB 비호환성)**: DB 초기화 후, SQLAlchemy가 SQLite에서 지원하지 않는 `UUID` 타입으로 테이블 생성을 시도하여 서버 시작이 실패했다.
3.  **`NameError` (import 누락)**: `GUID` 커스텀 타입을 도입하는 과정에서, `JSON`, `func`, `Numeric` 등 기본적인 SQLAlchemy 타입의 import를 누락하는 실수가 반복되어 서버 시작이 계속 실패했다.
4.  **`ValidationError` (데이터-스키마 불일치)**: 비동기 세션이 닫힌 후 SQLAlchemy의 lazy-loading이 시도되면서 `MissingGreenlet` 오류가 발생하거나, 모델과 Pydantic 스키마 간의 필드 불일치로 응답 생성에 실패했다.
5.  **`401 Unauthorized` (인증 키 불일치)**: `backend-api`와 `chat-server`가 사용하는 `JWT_SECRET_KEY`가 일치하지 않아 채팅 서버의 인증이 계속 실패했다.

## 🔑 해결 과정 및 최종 조치

- **1차 시도 (실패)**: `like`, `comment` 모델을 통합하고, `GUID` 타입을 도입하여 모든 모델, 서비스, API, 스키마를 수정했으나, 이 과정에서 너무 많은 파일이 변경되고 의존성이 꼬여 해결이 불가능한 상태에 빠짐.
- **2차 시도 (롤백)**: 더 이상의 수정을 중단하고, **`git reset --hard HEAD`** 및 **`git pull`** 을 통해 프로젝트 전체를 GitHub에 마지막으로 커밋된 가장 안정적인 버전으로 완전히 되돌렸다.

## ✅ 오늘의 성과
- 수많은 오류의 근본 원인이 **1) SQLite와 UUID 타입의 비호환성**, **2) 서버 간 JWT 키 불일치**, **3) 모델 구조의 복잡성**에 있음을 명확하게 진단했다.
- 더 이상의 "땜질식 처방"을 멈추고, 가장 안정적인 코드를 기반으로 문제를 다시 해결할 수 있도록 **깨끗한 개발 환경을 복원**했다.

## 🚀 다음 할 일
1.  **가장 먼저, `UUID` 호환성 문제 해결**: `database.py`에 `GUID` 커스텀 타입을 추가하고, 모든 모델 파일(`*.py`)에 `UUID` 대신 `GUID`를 적용하는 작업을 **신중하게** 다시 진행한다.
2.  **환경 변수 통일**: `.env` 파일을 사용하여 `backend-api`와 `chat-server`가 동일한 `JWT_SECRET_KEY`를 사용하도록 `docker-compose.dev.yml`을 설정한다.
3.  **DB 초기화 및 서버 실행**: 위 두 작업 완료 후, `docker compose down -v`로 DB를 완전히 초기화하고 `--build` 옵션으로 서버를 재시작하여 안정적으로 구동되는지 확인한다.